# Users

An active user is required to login and use RedSeed and to access the RedSeed API.

## User Attributes

Attribute | Type | Description
--------- | ------- | -----------
`id` | integer | A unique and autoincrementing identifier for the user which is generated by RedSeed automatically.
`code` | string | A unique employee code, eg. the employee's payroll identifier.
`firstName` | string | First name(s)
`lastName` | string | Last name(s)
`email` | string | Email address
`type` | string | 'HR', 'Manager', 'Trainee', 'System' - User type. Used to set user abilities & permissions.
`status` | string | 'Active', 'Archived' - User status. Archived users cannot access RedSeed, but can still be reported on.
`username` | string | A unique username for the user. This is used to login to RedSeed.
`locale` | string | User locale in ISO/IEC 15897 format. See supported user locales below. 
`marker` | boolean | Should this user be able to assess other users' coached activities?
`dateLastLogin` | datetime | The last time the user successfully logged in
`dateArchivedAt` | datetime | The datetime the user was last archived
`dateDeletedAt` | datetime | The datetime the user was deleted
`dateActivityAt` | datetime | The last recorded activity of the user
`dateCreatedAt` | datetime | The datetime the user record was created at
`dateUpdatedAt` | datetime | The datetime the user record was last updated
`location` | <a href="/#locations">Location</a> resource | The users location resource
`userRole` | <a href="/#user_roles">User role</a> resource | The user role. If the user is NOT assigned a user role this attribute will not be present.
`userIdentities` | array of <a href="/#user_identities">User Identity</a> resources | All User identity records assigned to the user. If the user has no user identities this attribute will not be present.

### Supported User Locales

Locale | Linguonym
--------- | -----------
`en_AU` | English (Aus)
`en_NZ` | English (NZ)
`en_US` | English (US)
`es_ES` | Español
`fr_FR` | Français
`id_ID` | Bahasa Indonesia
`ja_JP` | 日本語
`pt_BR` | Português
`th_TH` | ภาษาไทย

## Getting users
```shell
curl --location --request GET 'https://api.redseed.me/api/v0/users' \
--header 'Accept: application/json' \
--header 'Authorization: Bearer <YOUR_API_TOKEN>' \
--header 'Content-Type: application/json'

```
> The above command returns a JSON response structured like this:

```json
{
    "data": [
        // User resource array
    ],
    "links": {
        "first": "https://api.redseed.me/api/v0/users?page=1",
        "last": "https://api.redseed.me/api/v0/users?page=9",
        "prev": null,
        "next": "https://api.redseed.me/api/v0/users?page=2"
    },
    "meta": {
        "current_page": 1,
        "from": 1,
        "last_page": 9,
        "links": [
            // Pagination links
        ],
        "path": "https://api.redseed.me/api/v0/users",
        "per_page": 100,
        "to": 100,
        "total": 835
    }
}

```
This endpoint is used to fetch a list of users. It returns a JSON object that includes an array of user resources.

Results are returned in pages of 100 users. You can specify the page number to return using the `page` query parameter. If no page is specified, the first page will be returned.

Users that have been deleted will not be returned in the results.

### HTTP Requests
`
GET https://api.redseed.me/api/v0/users
`

`
GET https://api.redseed.me/api/v0/users/?page=<page_number>
`

`
GET https://api.redseed.me/api/v0/users/?location_id=<location_id>
`

`
GET https://api.redseed.me/api/v0/users/?location_id=<location_id>&status[]=Active
`

`
GET https://api.redseed.me/api/v0/users/?status[]=Active&status[]=Archived
`

`
GET https://api.redseed.me/api/v0/users/?email=user@example.com
`

### URL Parameters

Parameter | Description
--------- | -----------
`page` | The page of results to retrieve. If no page is specified, the first page will be returned.
`location_id` | Retrieve users from this location and its children
`status[]` | Retrieve users with this status. Supports multiple values.
`email` | Retrieve users with this exact email address. Returns both active and archived users.


## Getting a user's details
This endpoint is used to fetch details about a specific user. It returns a JSON object that includes the user's location and user role resources.

```shell
curl --location --request GET 'https://api.redseed.me/api/v0/users/188291' \
--header 'Authorization: Bearer <YOUR_API_TOKEN>'
```

> The above command returns a JSON response structured like this:

```json
{
    "data": {
        "id": 188291,
        "firstName": "API Test",
        "lastName": "User",
        "email": "apitestuser@redseed.com",
        "username": "apitest1",
        "code": null,
        "type": "HR",
        "status": "Active",
        "marker": 1,
        "locale": "en_NZ",
        "dateLastLogin": null,
        "dateCreatedAt": "2023-05-30T03:39:33.000000Z",
        "dateUpdatedAt": "2023-05-30T03:48:47.000000Z",
        "dateArchivedAt": null,
        "dateActivityAt": null,
        "location": {
            "id": 11728,
            "status": "ACTIVE",
            "description": "Demo",
            "code": null,
            "dateCreatedAt": null,
            "dateUpdatedAt": "2023-05-09T12:00:54.000000Z"
        },
        "userRole": {
            "id": 1588,
            "description": "Technical Engineer"
        },
        "userIdentities": []
    }
}
```
### HTTP Request
`
GET https://api.redseed.me/api/v0/users/<user_id>
`
### URL Parameters

Parameter | Description
--------- | -----------
`<user_id>` | The ID of the user


## Creating a new user
<!-- @todo: document how location.id works in content type application/x-www-form-urlencoded -->
```shell
curl --location --request POST 'https://api.redseed.me/api/v0/users' \
--header 'Accept: application/json' \
--header 'Authorization: Bearer {MY_API_TOKEN}' \
--header 'Content-Type: application/json' \
--data-raw '{
    "firstName": "First Name",
    "lastName": "Last Name",
    "type": "Trainee",
    "email": "test@email.com",
    "code": "employee_code_1234",
    "username": "username123",
    "marker": true,
    "locale": "en_AU",
    "location": {
        "id": 11234
    }
}'
```

> The above command returns JSON structured like this:

```json
{
    "id": 189814,
    "firstName": "Test",
    "lastName": "API User",
    "email": "test@email.com",
    "username": "username123",
    "code": "employee_code_1234",
    "type": "Trainee",
    "status": "Active",
    "marker": 1,
    "locale": "en_NZ",
    "dateLastLogin": null,
    "dateCreatedAt": "2023-06-21T22:31:30.000000Z",
    "dateUpdatedAt": "2023-06-21T22:31:30.000000Z",
    "dateArchivedAt": null,
    "dateActivityAt": null,
    "location": {
        "id": 11728,
        "status": "ACTIVE",
        "description": "Demo",
        "code": null,
        "dateCreatedAt": null,
        "dateUpdatedAt": "2023-06-09T12:00:55.000000Z"
    },
    "userRole": null,
    "userIdentities": []
}
```
### HTTP Request
`
POST https://api.redseed.me/api/v0/users
`
### Parameters

Attribute | Type | Required / Optional
--------- | --------- | ---------
`firstName` | String |Required
`lastName` | String | Required
`email` | String | Required
`type` | String | Required
`status` | String | Required
`username` | String | Required
`locale` | String | Required
`marker` | Boolean | Required
`locationId` | Integer | Required
`code` | String | Optional
`role.id` | Integer | Optional

See <a href="#user-attributes">User Attributes</a> for more information.

## Updating a user

```shell
curl --location --request PUT 'https://api.redseed.me/api/v0/users/188291' \
--header 'Accept: application/json' \
--header 'Authorization: Bearer {MY_API_TOKEN}' \
--header 'Content-Type: application/json' \
--data-raw '{
    "firstName": "API Test",
    "lastName": "User",
    "type": "HR",
    "status": "Active",
    "marker": 1,
    "locale": "en_NZ",
    "location":{ "id": 11728},
    "email": "newEmailAddress@mail.com",
    "username": "apitest1"
}'
```

> The above command returns JSON structured like this:

```json
{
    "id": 188291,
    "firstName": "API Test",
    "lastName": "User",
    "email": "newEmailAddress@mail.com",
    "username": "apitest1",
    "code": null,
    "type": "HR",
    "status": "Active",
    "marker": 1,
    "locale": "en_NZ",
    "dateLastLogin": "2023-06-07 16:09:40",
    "dateCreatedAt": "2023-05-30T03:39:33.000000Z",
    "dateUpdatedAt": "2023-06-23T01:01:06.000000Z",
    "dateArchivedAt": null,
    "dateActivityAt": "2023-06-07T04:11:24.000000Z"
}
```
### HTTP Request
`
PUT https://api.redseed.me/api/v0/users/<user_id>
`
### URL Parameters

Parameter | Description
--------- | -----------
`<user_id>` | The ID of the user

### Parameters

Attribute | Type | Required / Optional
--------- | --------- | ---------
`firstName` | String |Required
`lastName` | String | Required
`email` | String | Required
`type` | String | Required
`status` | String | Required
`username` | String | Required
`locale` | String | Required
`marker` | Boolean | Required
`locationId` | Integer | Required
`code` | String | Optional
`role.id` | Integer | Optional

See <a href="#user-attributes">User Attributes</a> for more information.

## Deleting a user

Users that have been deleted will not be returned in any other API responses. There is currently no way to restore a deleted user via the API. Please contact support if you need to restore a deleted user.

```shell
curl --location --request DELETE 'https://api.redseed.me/api/v0/users/188291' \
--header 'Accept: application/json' \
--header 'Authorization: Bearer {MY_API_TOKEN}' \
--header 'Content-Type: application/json'
```

> The above command returns JSON structured like this:

```json
{
    "id": 188291,
    "firstName": "API Test",
    "lastName": "User",
    "email": "newEmailAddress@mail.com",
    "username": "apitest1",
    "code": null,
    "type": "HR",
    "status": "Active",
    "marker": 1,
    "locale": "en_NZ",
    "dateLastLogin": "2023-06-07 16:09:40",
    "dateCreatedAt": "2023-05-30T03:39:33.000000Z",
    "dateUpdatedAt": "2023-06-23T01:01:06.000000Z",
    "dateArchivedAt": null,
    "dateDeletedAt": "2025-01-22T08:15:00.000000Z",
    "dateActivityAt": "2023-06-07T04:11:24.000000Z"
}
```
### HTTP Request
`
DELETE https://api.redseed.me/api/v0/users/<user_id>
`
### URL Parameters

Parameter | Description
--------- | -----------
`<user_id>` | The ID of the user
